diff --git a/node_modules/react-native-iap/android/build.gradle b/node_modules/react-native-iap/android/build.gradle
index 1234567..89abcde 100644
--- a/node_modules/react-native-iap/android/build.gradle
+++ b/node_modules/react-native-iap/android/build.gradle
@@ -1,6 +1,6 @@
 buildscript {
   // Buildscript is evaluated before everything else so we can't use getExtOrDefault
-  def kotlinVersion = rootProject.ext.has("kotlinVersion") ? rootProject.ext.get("kotlinVersion") : project.properties["RNIap_kotlinVersion"]
+  def kotlinVersion = project.properties["RNIap_kotlinVersion"] ?: "1.8.0"
 
   repositories {
     google()
diff --git a/node_modules/react-native-iap/android/src/main/java/com/dooboolab/rniap/PromiseUtlis.kt b/node_modules/react-native-iap/android/src/main/java/com/dooboolab/rniap/PromiseUtlis.kt
index 1111111..2222222 100644
--- a/node_modules/react-native-iap/android/src/main/java/com/dooboolab/rniap/PromiseUtlis.kt
+++ b/node_modules/react-native-iap/android/src/main/java/com/dooboolab/rniap/PromiseUtlis.kt
@@ -1,9 +1,8 @@
 package com.dooboolab.rniap
 
 import android.util.Log
-import com.facebook.react.bridge.ObjectAlreadyConsumedException
 import com.facebook.react.bridge.Promise
 
 /**
  * Extension functions used to simplify promise handling since we don't
@@ -14,7 +13,7 @@ const val TAG = "IapPromises"
 fun Promise.safeResolve(value: Any?) {
     try {
         this.resolve(value)
-    } catch (oce: ObjectAlreadyConsumedException) {
-        Log.d(TAG, "Already consumed ${oce.message}")
+    } catch (e: Exception) {
+        Log.d(TAG, "Already consumed ${e.message}")
     }
 }
 
@@ -35,9 +34,9 @@ fun Promise.safeReject(
     throwable: Throwable?,
 ) {
     try {
-        this.reject(code, message, throwable)
-    } catch (oce: ObjectAlreadyConsumedException) {
-        Log.d(TAG, "Already consumed ${oce.message}")
+        this.reject(code ?: "E_UNKNOWN", message ?: "", throwable)
+    } catch (e: Exception) {
+        Log.d(TAG, "Already consumed ${e.message}")
     }
 }
diff --git a/node_modules/react-native-iap/android/src/play/java/com/dooboolab/rniap/RNIapModule.kt b/node_modules/react-native-iap/android/src/play/java/com/dooboolab/rniap/RNIapModule.kt
index 3333333..4444444 100644
--- a/node_modules/react-native-iap/android/src/play/java/com/dooboolab/rniap/RNIapModule.kt
+++ b/node_modules/react-native-iap/android/src/play/java/com/dooboolab/rniap/RNIapModule.kt
@@ -1,5 +1,6 @@
 package com.dooboolab.rniap
 
+import android.app.Activity
 import android.util.Log
 import com.android.billingclient.api.AcknowledgePurchaseParams
 import com.android.billingclient.api.BillingClient
@@ -455,7 +456,7 @@ class RNIapModule(
         isOfferPersonalized: Boolean, // New parameter in V5
         promise: Promise,
     ) {
-        val activity = currentActivity
+        val activity = getCurrentActivity()
         if (activity == null) {
             promise.safeReject(PromiseUtils.E_UNKNOWN, "getCurrentActivity returned null")
             return
@@ -536,7 +537,7 @@ class RNIapModule(
             }
 
             val flowParams = builder.build()
-            val billingResultCode = billingClient.launchBillingFlow(activity, flowParams).responseCode
+            val billingResultCode = billingClient.launchBillingFlow(activity as Activity, flowParams).responseCode
             if (billingResultCode != BillingClient.BillingResponseCode.OK) {
                 val errorData = PlayUtils.getBillingResponseData(billingResultCode)
                 promise.safeReject(errorData.code, errorData.message)
