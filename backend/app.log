/Users/tarunydv/Desktop/Code/AstrologyApp/backend/venv/lib/python3.9/site-packages/google/api_core/_python_version_support.py:252: FutureWarning: You are using a Python version (3.9.6) past its end of life. Google will update google.api_core with critical bug fixes on a best-effort basis, but not with any other fixes or features. Please upgrade to the latest Python version, or at least Python 3.10, and then update google.api_core.
  warnings.warn(message, FutureWarning)
/Users/tarunydv/Desktop/Code/AstrologyApp/backend/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
/Users/tarunydv/Desktop/Code/AstrologyApp/backend/main.py:167: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.5/migration/
  @validator('timezone')
/Users/tarunydv/Desktop/Code/AstrologyApp/backend/main.py:2640: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
INFO:     Started server process [17332]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8001 (Press CTRL+C to quit)
Warning: Could not initialize house combinations database: name 'init_house_combinations_db' is not defined
An error occurred: module 'importlib.metadata' has no attribute 'packages_distributions'
Loaded .env from: .env
Loaded .env from: .env
Loaded environment variables from .env file
Database initialized successfully
Starting Astrology API server on port 8001...
Daily prediction engine initialized with updated rules
House combinations and chat history databases initialized
[2025-11-08 21:56:32] GET /logo192.png - Client: None
[2025-11-08 21:56:32] Response: 404 - Time: 0.00s
INFO:     None:0 - "GET /logo192.png HTTP/1.1" 404 Not Found
[2025-11-08 21:56:33] GET /logo192.png - Client: None
[2025-11-08 21:56:33] Response: 404 - Time: 0.00s
INFO:     None:0 - "GET /logo192.png HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:64259 - "OPTIONS /api/me HTTP/1.1" 200 OK
[2025-11-08 21:56:45] GET /api/me - Client: 127.0.0.1
[2025-11-08 21:56:45] Response: 200 - Time: 0.00s
INFO:     127.0.0.1:64259 - "GET /api/me HTTP/1.1" 200 OK
[2025-11-08 21:56:45] GET /api/horoscope/all-signs - Client: 127.0.0.1
[2025-11-08 21:56:45] Response: 200 - Time: 0.01s
INFO:     127.0.0.1:64261 - "OPTIONS /api/birth-charts?limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64265 - "OPTIONS /api/calculate-panchang HTTP/1.1" 200 OK
INFO:     127.0.0.1:64267 - "OPTIONS /api/birth-charts?limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64268 - "OPTIONS /api/panchang/calculate-sunrise-sunset HTTP/1.1" 200 OK
INFO:     127.0.0.1:64269 - "OPTIONS /api/panchang/choghadiya?date=2025-11-08&latitude=28.6139&longitude=77.209 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64261 - "OPTIONS /api/panchang/hora?date=2025-11-08&latitude=28.6139&longitude=77.209 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64265 - "OPTIONS /api/panchang/special-muhurtas?date=2025-11-08&latitude=28.6139&longitude=77.209 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64259 - "GET /api/horoscope/all-signs HTTP/1.1" 200 OK
[2025-11-08 21:56:45] POST /api/calculate-panchang - Client: 127.0.0.1
[2025-11-08 21:56:45] POST /api/panchang/calculate-sunrise-sunset - Client: 127.0.0.1
[2025-11-08 21:56:45] GET /api/birth-charts - Client: 127.0.0.1
[2025-11-08 21:56:45] GET /api/birth-charts - Client: 127.0.0.1
[2025-11-08 21:56:45] GET /api/panchang/choghadiya - Client: 127.0.0.1
Search query: '', Limit: 50
No search query, returning all charts
Found 9 charts
[2025-11-08 21:56:45] Response: 200 - Time: 0.01s
Search query: '', Limit: 50
No search query, returning all charts
Found 9 charts
[2025-11-08 21:56:45] Response: 200 - Time: 0.01s
[2025-11-08 21:56:45] Response: 422 - Time: 0.02s
[2025-11-08 21:56:45] Response: 200 - Time: 0.02s
[2025-11-08 21:56:45] Response: 200 - Time: 0.01s
INFO:     127.0.0.1:64265 - "GET /api/panchang/choghadiya?date=2025-11-08&latitude=28.6139&longitude=77.209 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64269 - "GET /api/birth-charts?limit=50 HTTP/1.1" 200 OK
[2025-11-08 21:56:45] GET /api/panchang/hora - Client: 127.0.0.1
INFO:     127.0.0.1:64267 - "POST /api/calculate-panchang HTTP/1.1" 422 Unprocessable Entity
INFO:     127.0.0.1:64268 - "POST /api/panchang/calculate-sunrise-sunset HTTP/1.1" 200 OK
INFO:     127.0.0.1:64261 - "GET /api/birth-charts?limit=50 HTTP/1.1" 200 OK
[2025-11-08 21:56:45] Response: 200 - Time: 0.00s
INFO:     127.0.0.1:64259 - "GET /api/panchang/hora?date=2025-11-08&latitude=28.6139&longitude=77.209 HTTP/1.1" 200 OK
[2025-11-08 21:56:45] GET /api/panchang/special-muhurtas - Client: 127.0.0.1
[2025-11-08 21:56:45] Response: 200 - Time: 0.00s
INFO:     127.0.0.1:64265 - "GET /api/panchang/special-muhurtas?date=2025-11-08&latitude=28.6139&longitude=77.209 HTTP/1.1" 200 OK
[2025-11-08 21:56:46] GET /logo192.png - Client: None
[2025-11-08 21:56:46] Response: 404 - Time: 0.00s
INFO:     None:0 - "GET /logo192.png HTTP/1.1" 404 Not Found
[2025-11-08 21:56:56] GET /api/birth-charts - Client: 127.0.0.1
Search query: '', Limit: 50
No search query, returning all charts
Found 9 charts
[2025-11-08 21:56:56] Response: 200 - Time: 0.01s
INFO:     127.0.0.1:64265 - "GET /api/birth-charts?limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64265 - "OPTIONS /api/calculate-chart?node_type=mean HTTP/1.1" 200 OK
INFO:     127.0.0.1:64259 - "OPTIONS /api/calculate-yogi HTTP/1.1" 200 OK
[2025-11-08 21:56:59] POST /api/calculate-chart - Client: 127.0.0.1
[2025-11-08 21:56:59] POST /api/calculate-yogi - Client: 127.0.0.1
[2025-11-08 21:56:59] Response: 200 - Time: 0.00s
INFO:     127.0.0.1:64259 - "POST /api/calculate-yogi HTTP/1.1" 200 OK
[2025-11-08 21:56:59] Response: 200 - Time: 0.01s
INFO:     127.0.0.1:64265 - "POST /api/calculate-chart?node_type=mean HTTP/1.1" 200 OK
[2025-11-08 21:56:59] POST /api/chat/history - Client: None
[2025-11-08 21:56:59] GET /api/birth-charts - Client: 127.0.0.1
Search query: '', Limit: 50
No search query, returning all charts
Found 9 charts
[2025-11-08 21:56:59] Response: 200 - Time: 0.01s
[2025-11-08 21:56:59] Response: 200 - Time: 0.01s
INFO:     None:0 - "POST /api/chat/history HTTP/1.1" 200 OK
INFO:     127.0.0.1:64265 - "GET /api/birth-charts?limit=50 HTTP/1.1" 200 OK
[2025-11-08 21:57:03] POST /api/chat/session - Client: None
[2025-11-08 21:57:03] Response: 200 - Time: 0.01s
INFO:     None:0 - "POST /api/chat/session HTTP/1.1" 200 OK
[2025-11-08 21:57:03] POST /api/chat/message - Client: None
[2025-11-08 21:57:03] Response: 200 - Time: 0.01s
INFO:     None:0 - "POST /api/chat/message HTTP/1.1" 200 OK
[2025-11-08 21:57:03] POST /api/chat/ask - Client: None

=== STREAMING STARTED ===
Request question: What do the current transits mean for me?
Request data: name='Deepika Yadav' date='1981-03-22' time='16:07' place='28.1956468, 76.6165179' latitude=28.1956468 longitude=76.6165179 timezone='UTC+5' gender=None question='What do the current transits mean for me?' language='english' response_style='detailed'
DEBUG: Valid planets in chart: ['Sun', 'Moon', 'Mars', 'Mercury', 'Jupiter', 'Venus', 'Saturn']
DEBUG: Sun - House: 8, Sign: 11
DEBUG: Moon - House: 2, Sign: 5
DEBUG: Mars - House: 8, Sign: 11
DEBUG: Mercury - House: 7, Sign: 10
DEBUG: Jupiter - House: 2, Sign: 5
DEBUG: Venus - House: 8, Sign: 11
DEBUG: Saturn - House: 2, Sign: 5
DEBUG: Houses occupied: {8, 2, 7}
DEBUG: Found 0 Raj Yogas

=== CHAT ROUTE DEBUG ===
Question: What do the current transits mean for me?
Birth data: {'name': 'Deepika Yadav', 'date': '1981-03-22', 'time': '16:07', 'place': '28.1956468, 76.6165179', 'latitude': 28.1956468, 'longitude': 76.6165179, 'timezone': 'UTC+5', 'gender': None}
Context type: <class 'dict'>
History length: 0

=== SENDING TO AI ===
Question: What do the current transits mean for me?
Prompt length: 143594 chars
Context keys: ['birth_details', 'ascendant_info', 'd1_chart', 'divisional_charts', 'planetary_analysis', 'special_points', 'relationships', 'yogas', 'chara_karakas', 'advanced_analysis', 'current_dashas', 'current_date_info']
History messages: 0

=== RECEIVED FROM AI ===
Response length: 18951 chars
Response preview: <div class="quick-answer-card">**Quick Answer**: As no specific transit data has been provided, a detailed analysis of current transits is not possible. However, based on your active *Vimshottari Dash...
AI result success: True
AI result keys: ['success', 'response', 'raw_response']
Sending response length: 18951
Response preview: <div class="quick-answer-card">**Quick Answer**: As no specific transit data has been provided, a de...
[2025-11-08 21:57:50] Response: 200 - Time: 46.53s
INFO:     None:0 - "POST /api/chat/ask HTTP/1.1" 200 OK
[2025-11-08 21:57:50] POST /api/chat/message - Client: None
[2025-11-08 21:57:50] Response: 200 - Time: 0.01s
INFO:     None:0 - "POST /api/chat/message HTTP/1.1" 200 OK
[2025-11-08 22:02:44] POST /api/chat/history - Client: None
[2025-11-08 22:02:44] Response: 200 - Time: 0.00s
INFO:     None:0 - "POST /api/chat/history HTTP/1.1" 200 OK
[2025-11-08 22:02:49] POST /api/chat/session - Client: None
[2025-11-08 22:02:49] Response: 200 - Time: 0.01s
INFO:     None:0 - "POST /api/chat/session HTTP/1.1" 200 OK
[2025-11-08 22:02:49] POST /api/chat/message - Client: None
[2025-11-08 22:02:49] Response: 200 - Time: 0.01s
INFO:     None:0 - "POST /api/chat/message HTTP/1.1" 200 OK
[2025-11-08 22:02:49] POST /api/chat/ask - Client: None

=== STREAMING STARTED ===
Request question: What does my birth chart say about my career?
Request data: name='Deepika Yadav' date='1981-03-22' time='16:07' place='28.1956468, 76.6165179' latitude=28.1956468 longitude=76.6165179 timezone='UTC+5' gender=None question='What does my birth chart say about my career?' language='english' response_style='detailed'

=== CHAT ROUTE DEBUG ===
Question: What does my birth chart say about my career?
Birth data: {'name': 'Deepika Yadav', 'date': '1981-03-22', 'time': '16:07', 'place': '28.1956468, 76.6165179', 'latitude': 28.1956468, 'longitude': 76.6165179, 'timezone': 'UTC+5', 'gender': None}
Context type: <class 'dict'>
History length: 0

=== SENDING TO AI ===
Question: What does my birth chart say about my career?
Prompt length: 145343 chars
Context keys: ['birth_details', 'ascendant_info', 'd1_chart', 'divisional_charts', 'planetary_analysis', 'special_points', 'relationships', 'yogas', 'chara_karakas', 'advanced_analysis', 'current_dashas', 'transit_activations', 'current_date_info']
History messages: 0

=== RECEIVED FROM AI ===
Response length: 15546 chars
Response preview: <div class="quick-answer-card">**Quick Answer**: Your birth chart for Leo Ascendant at age 44 indicates a career path characterized by profound transformation, research, or working with hidden aspects...
AI result success: True
AI result keys: ['success', 'response', 'raw_response']
Sending response length: 15546
Response preview: <div class="quick-answer-card">**Quick Answer**: Your birth chart for Leo Ascendant at age 44 indica...
[2025-11-08 22:03:36] Response: 200 - Time: 47.47s
[2025-11-08 22:03:36] GET /api/me - Client: 127.0.0.1
[2025-11-08 22:03:36] GET /api/horoscope/all-signs - Client: 127.0.0.1
[2025-11-08 22:03:36] POST /api/calculate-panchang - Client: 127.0.0.1
[2025-11-08 22:03:36] POST /api/panchang/calculate-sunrise-sunset - Client: 127.0.0.1
[2025-11-08 22:03:36] GET /api/birth-charts - Client: 127.0.0.1
[2025-11-08 22:03:36] GET /api/birth-charts - Client: 127.0.0.1
INFO:     None:0 - "POST /api/chat/ask HTTP/1.1" 200 OK
[2025-11-08 22:03:36] Response: 200 - Time: 0.01s
INFO:     127.0.0.1:49417 - "GET /api/horoscope/all-signs HTTP/1.1" 200 OK
[2025-11-08 22:03:36] Response: 422 - Time: 0.02s
[2025-11-08 22:03:36] Response: 200 - Time: 0.02s
Search query: '', Limit: 50
No search query, returning all charts
Found 9 charts
Search query: '', Limit: 50
No search query, returning all charts
Found 9 charts
[2025-11-08 22:03:36] Response: 200 - Time: 0.02s
[2025-11-08 22:03:36] Response: 200 - Time: 0.02s
INFO:     127.0.0.1:49419 - "POST /api/calculate-panchang HTTP/1.1" 422 Unprocessable Entity
INFO:     127.0.0.1:49421 - "POST /api/panchang/calculate-sunrise-sunset HTTP/1.1" 200 OK
[2025-11-08 22:03:36] Response: 200 - Time: 0.02s
INFO:     127.0.0.1:49425 - "GET /api/birth-charts?limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:49415 - "GET /api/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:49424 - "GET /api/birth-charts?limit=50 HTTP/1.1" 200 OK
[2025-11-08 22:03:36] GET /api/panchang/choghadiya - Client: 127.0.0.1
[2025-11-08 22:03:36] Response: 200 - Time: 0.00s
[2025-11-08 22:03:36] GET /api/panchang/hora - Client: 127.0.0.1
[2025-11-08 22:03:36] GET /api/panchang/special-muhurtas - Client: 127.0.0.1
INFO:     127.0.0.1:49417 - "GET /api/panchang/choghadiya?date=2025-11-08&latitude=28.6139&longitude=77.209 HTTP/1.1" 200 OK
[2025-11-08 22:03:36] GET /api/birth-charts - Client: 127.0.0.1
[2025-11-08 22:03:36] Response: 200 - Time: 0.00s
[2025-11-08 22:03:36] Response: 200 - Time: 0.00s
INFO:     127.0.0.1:49419 - "GET /api/panchang/hora?date=2025-11-08&latitude=28.6139&longitude=77.209 HTTP/1.1" 200 OK
INFO:     127.0.0.1:49421 - "GET /api/panchang/special-muhurtas?date=2025-11-08&latitude=28.6139&longitude=77.209 HTTP/1.1" 200 OK
Search query: '', Limit: 50
No search query, returning all charts
Found 9 charts
[2025-11-08 22:03:36] POST /api/chat/message - Client: None
[2025-11-08 22:03:36] Response: 200 - Time: 0.01s
INFO:     127.0.0.1:49425 - "GET /api/birth-charts?limit=50 HTTP/1.1" 200 OK
[2025-11-08 22:03:37] Response: 200 - Time: 0.01s
INFO:     None:0 - "POST /api/chat/message HTTP/1.1" 200 OK
[2025-11-08 22:04:21] POST /api/calculate-chart - Client: 127.0.0.1
[2025-11-08 22:04:21] POST /api/calculate-yogi - Client: 127.0.0.1
[2025-11-08 22:04:21] Response: 200 - Time: 0.00s
INFO:     127.0.0.1:49421 - "POST /api/calculate-yogi HTTP/1.1" 200 OK
[2025-11-08 22:04:21] Response: 200 - Time: 0.02s
INFO:     127.0.0.1:49425 - "POST /api/calculate-chart?node_type=mean HTTP/1.1" 200 OK
[2025-11-08 22:04:21] POST /api/chat/history - Client: None
[2025-11-08 22:04:21] GET /api/birth-charts - Client: 127.0.0.1
Search query: '', Limit: 50
No search query, returning all charts
Found 9 charts
[2025-11-08 22:04:21] Response: 200 - Time: 0.01s
[2025-11-08 22:04:21] Response: 200 - Time: 0.01s
INFO:     None:0 - "POST /api/chat/history HTTP/1.1" 200 OK
INFO:     127.0.0.1:49425 - "GET /api/birth-charts?limit=50 HTTP/1.1" 200 OK
[2025-11-08 22:04:24] POST /api/chat/session - Client: None
[2025-11-08 22:04:24] Response: 200 - Time: 0.01s
INFO:     None:0 - "POST /api/chat/session HTTP/1.1" 200 OK
[2025-11-08 22:04:24] POST /api/chat/message - Client: None
[2025-11-08 22:04:24] Response: 200 - Time: 0.01s
INFO:     None:0 - "POST /api/chat/message HTTP/1.1" 200 OK
[2025-11-08 22:04:24] POST /api/chat/ask - Client: None

=== STREAMING STARTED ===
Request question: What do the current transits mean for me?
Request data: name='Deepika Yadav' date='1981-03-22' time='16:07' place='28.1956468, 76.6165179' latitude=28.1956468 longitude=76.6165179 timezone='UTC+5' gender=None question='What do the current transits mean for me?' language='english' response_style='detailed'

=== CHAT ROUTE DEBUG ===
Question: What do the current transits mean for me?
Birth data: {'name': 'Deepika Yadav', 'date': '1981-03-22', 'time': '16:07', 'place': '28.1956468, 76.6165179', 'latitude': 28.1956468, 'longitude': 76.6165179, 'timezone': 'UTC+5', 'gender': None}
Context type: <class 'dict'>
History length: 0

=== SENDING TO AI ===
Question: What do the current transits mean for me?
Prompt length: 143594 chars
Context keys: ['birth_details', 'ascendant_info', 'd1_chart', 'divisional_charts', 'planetary_analysis', 'special_points', 'relationships', 'yogas', 'chara_karakas', 'advanced_analysis', 'current_dashas', 'current_date_info']
History messages: 0

=== RECEIVED FROM AI ===
Response length: 17499 chars
Response preview: <div class="quick-answer-card">**Quick Answer**: An accurate assessment of current transits is not possible as specific planetary transit positions for today, November 08, 2025, were not provided in t...
AI result success: True
AI result keys: ['success', 'response', 'raw_response']
Sending response length: 17499
Response preview: <div class="quick-answer-card">**Quick Answer**: An accurate assessment of current transits is not p...
[2025-11-08 22:04:56] Response: 200 - Time: 32.42s
INFO:     None:0 - "POST /api/chat/ask HTTP/1.1" 200 OK
[2025-11-08 22:04:56] POST /api/chat/message - Client: None
[2025-11-08 22:04:56] Response: 200 - Time: 0.02s
INFO:     None:0 - "POST /api/chat/message HTTP/1.1" 200 OK
