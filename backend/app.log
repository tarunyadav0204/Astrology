/Users/tarunydv/Desktop/Code/AstrologyApp/backend/venv/lib/python3.9/site-packages/google/api_core/_python_version_support.py:252: FutureWarning: You are using a Python version (3.9.6) past its end of life. Google will update google.api_core with critical bug fixes on a best-effort basis, but not with any other fixes or features. Please upgrade to the latest Python version, or at least Python 3.10, and then update google.api_core.
  warnings.warn(message, FutureWarning)
/Users/tarunydv/Desktop/Code/AstrologyApp/backend/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
/Users/tarunydv/Desktop/Code/AstrologyApp/backend/main.py:167: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.5/migration/
  @validator('timezone')
/Users/tarunydv/Desktop/Code/AstrologyApp/backend/main.py:2640: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
INFO:     Started server process [92845]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8001 (Press CTRL+C to quit)
Warning: Could not initialize house combinations database: name 'init_house_combinations_db' is not defined
An error occurred: module 'importlib.metadata' has no attribute 'packages_distributions'
Loaded .env from: .env
Loaded .env from: .env
Loaded environment variables from .env file
Database initialized successfully
Starting Astrology API server on port 8001...
Daily prediction engine initialized with updated rules
House combinations and chat history databases initialized
[2025-11-08 19:30:42] GET /api/me - Client: 127.0.0.1
[2025-11-08 19:30:42] Response: 200 - Time: 0.01s
INFO:     127.0.0.1:57018 - "GET /api/me HTTP/1.1" 200 OK
[2025-11-08 19:30:42] GET /api/horoscope/all-signs - Client: 127.0.0.1
[2025-11-08 19:30:42] Response: 200 - Time: 0.01s
[2025-11-08 19:30:42] POST /api/calculate-panchang - Client: 127.0.0.1
[2025-11-08 19:30:42] POST /api/panchang/calculate-sunrise-sunset - Client: 127.0.0.1
[2025-11-08 19:30:42] GET /api/birth-charts - Client: 127.0.0.1
[2025-11-08 19:30:42] GET /api/birth-charts - Client: 127.0.0.1
[2025-11-08 19:30:42] GET /api/panchang/choghadiya - Client: 127.0.0.1
INFO:     127.0.0.1:57018 - "GET /api/horoscope/all-signs HTTP/1.1" 200 OK
[2025-11-08 19:30:42] Response: 200 - Time: 0.01s
INFO:     127.0.0.1:57028 - "GET /api/panchang/choghadiya?date=2025-11-08&latitude=28.6139&longitude=77.209 HTTP/1.1" 200 OK
[2025-11-08 19:30:42] Response: 422 - Time: 0.01s
[2025-11-08 19:30:42] Response: 200 - Time: 0.01s
Search query: '', Limit: 50
No search query, returning all charts
Found 9 charts
Search query: '', Limit: 50
No search query, returning all charts
Found 9 charts
[2025-11-08 19:30:42] Response: 200 - Time: 0.01s
[2025-11-08 19:30:42] Response: 200 - Time: 0.01s
INFO:     127.0.0.1:57020 - "POST /api/calculate-panchang HTTP/1.1" 422 Unprocessable Entity
INFO:     127.0.0.1:57022 - "POST /api/panchang/calculate-sunrise-sunset HTTP/1.1" 200 OK
[2025-11-08 19:30:42] GET /api/panchang/hora - Client: 127.0.0.1
INFO:     127.0.0.1:57026 - "GET /api/birth-charts?limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:57025 - "GET /api/birth-charts?limit=50 HTTP/1.1" 200 OK
[2025-11-08 19:30:42] Response: 200 - Time: 0.00s
[2025-11-08 19:30:42] GET /api/panchang/special-muhurtas - Client: 127.0.0.1
INFO:     127.0.0.1:57018 - "GET /api/panchang/hora?date=2025-11-08&latitude=28.6139&longitude=77.209 HTTP/1.1" 200 OK
[2025-11-08 19:30:42] Response: 200 - Time: 0.00s
INFO:     127.0.0.1:57028 - "GET /api/panchang/special-muhurtas?date=2025-11-08&latitude=28.6139&longitude=77.209 HTTP/1.1" 200 OK
[2025-11-08 19:30:43] GET /logo192.png - Client: None
[2025-11-08 19:30:43] Response: 404 - Time: 0.00s
INFO:     None:0 - "GET /logo192.png HTTP/1.1" 404 Not Found
[2025-11-08 19:30:48] GET /api/birth-charts - Client: 127.0.0.1
Search query: '', Limit: 50
No search query, returning all charts
Found 9 charts
[2025-11-08 19:30:48] Response: 200 - Time: 0.01s
INFO:     127.0.0.1:57028 - "GET /api/birth-charts?limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:57028 - "OPTIONS /api/calculate-chart?node_type=mean HTTP/1.1" 200 OK
INFO:     127.0.0.1:57018 - "OPTIONS /api/calculate-yogi HTTP/1.1" 200 OK
[2025-11-08 19:30:50] POST /api/calculate-chart - Client: 127.0.0.1
[2025-11-08 19:30:50] POST /api/calculate-yogi - Client: 127.0.0.1
[2025-11-08 19:30:50] Response: 200 - Time: 0.00s
INFO:     127.0.0.1:57018 - "POST /api/calculate-yogi HTTP/1.1" 200 OK
[2025-11-08 19:30:50] Response: 200 - Time: 0.02s
INFO:     127.0.0.1:57028 - "POST /api/calculate-chart?node_type=mean HTTP/1.1" 200 OK
[2025-11-08 19:30:50] POST /api/chat/history - Client: None
[2025-11-08 19:30:50] Response: 200 - Time: 0.01s
[2025-11-08 19:30:50] GET /api/birth-charts - Client: 127.0.0.1
INFO:     None:0 - "POST /api/chat/history HTTP/1.1" 200 OK
Search query: '', Limit: 50
No search query, returning all charts
Found 9 charts
[2025-11-08 19:30:50] Response: 200 - Time: 0.01s
INFO:     127.0.0.1:57028 - "GET /api/birth-charts?limit=50 HTTP/1.1" 200 OK
[2025-11-08 19:31:08] POST /api/chat/session - Client: None
[2025-11-08 19:31:08] Response: 200 - Time: 0.01s
INFO:     None:0 - "POST /api/chat/session HTTP/1.1" 200 OK
[2025-11-08 19:31:08] POST /api/chat/message - Client: None
[2025-11-08 19:31:08] Response: 200 - Time: 0.01s
INFO:     None:0 - "POST /api/chat/message HTTP/1.1" 200 OK
[2025-11-08 19:31:08] POST /api/chat/ask - Client: None

=== STREAMING STARTED ===
Request question: How is my next month.
Request data: name='Deepika Yadav' date='1981-03-22' time='16:07' place='28.1956468, 76.6165179' latitude=28.1956468 longitude=76.6165179 timezone='UTC+5' gender=None question='How is my next month.' language='english' response_style='concise'
DEBUG: Valid planets in chart: ['Sun', 'Moon', 'Mars', 'Mercury', 'Jupiter', 'Venus', 'Saturn']
DEBUG: Sun - House: 8, Sign: 11
DEBUG: Moon - House: 2, Sign: 5
DEBUG: Mars - House: 8, Sign: 11
DEBUG: Mercury - House: 7, Sign: 10
DEBUG: Jupiter - House: 2, Sign: 5
DEBUG: Venus - House: 8, Sign: 11
DEBUG: Saturn - House: 2, Sign: 5
DEBUG: Houses occupied: {8, 2, 7}
DEBUG: Found 0 Raj Yogas

=== CHAT ROUTE DEBUG ===
Question: How is my next month.
Birth data: {'name': 'Deepika Yadav', 'date': '1981-03-22', 'time': '16:07', 'place': '28.1956468, 76.6165179', 'latitude': 28.1956468, 'longitude': 76.6165179, 'timezone': 'UTC+5', 'gender': None}
Context type: <class 'dict'>
History length: 0

=== SENDING TO AI ===
Question: How is my next month.
Prompt length: 145127 chars
Context keys: ['birth_details', 'ascendant_info', 'd1_chart', 'divisional_charts', 'planetary_analysis', 'special_points', 'relationships', 'yogas', 'chara_karakas', 'advanced_analysis', 'current_dashas', 'transit_activations', 'current_date_info']
History messages: 0

=== RECEIVED FROM AI ===
Response length: 621 chars
Response preview: **Quick Answer**: Next month (December 2025) may bring challenges related to sudden events or health, particularly concerning family and property matters. The Pratyantardasha of **Mars**, which is com...
AI result success: True
AI result keys: ['success', 'response', 'raw_response']
Sending response length: 621
Response preview: **Quick Answer**: Next month (December 2025) may bring challenges related to sudden events or health...
[2025-11-08 19:31:23] Response: 200 - Time: 15.83s
INFO:     None:0 - "POST /api/chat/ask HTTP/1.1" 200 OK
[2025-11-08 19:31:23] POST /api/chat/message - Client: None
[2025-11-08 19:31:23] Response: 200 - Time: 0.01s
INFO:     None:0 - "POST /api/chat/message HTTP/1.1" 200 OK
[2025-11-08 19:32:27] POST /api/chat/message - Client: None
[2025-11-08 19:32:27] Response: 200 - Time: 0.02s
INFO:     None:0 - "POST /api/chat/message HTTP/1.1" 200 OK
[2025-11-08 19:32:27] POST /api/chat/ask - Client: None

=== STREAMING STARTED ===
Request question: These events will be related to which body part?
Request data: name='Deepika Yadav' date='1981-03-22' time='16:07' place='28.1956468, 76.6165179' latitude=28.1956468 longitude=76.6165179 timezone='UTC+5' gender=None question='These events will be related to which body part?' language='english' response_style='concise'

=== CHAT ROUTE DEBUG ===
Question: These events will be related to which body part?
Birth data: {'name': 'Deepika Yadav', 'date': '1981-03-22', 'time': '16:07', 'place': '28.1956468, 76.6165179', 'latitude': 28.1956468, 'longitude': 76.6165179, 'timezone': 'UTC+5', 'gender': None}
Context type: <class 'dict'>
History length: 0

=== SENDING TO AI ===
Question: These events will be related to which body part?
Prompt length: 143409 chars
Context keys: ['birth_details', 'ascendant_info', 'd1_chart', 'divisional_charts', 'planetary_analysis', 'special_points', 'relationships', 'yogas', 'chara_karakas', 'advanced_analysis', 'current_dashas', 'current_date_info']
History messages: 0

=== RECEIVED FROM AI ===
Response length: 618 chars
Response preview: **Quick Answer**: These events will likely relate to the **feet, reproductive, and excretory systems**, along with general vitality, due to the **Lagna Lord Sun** (ruler of the body) being placed in t...
AI result success: True
AI result keys: ['success', 'response', 'raw_response']
Sending response length: 618
Response preview: **Quick Answer**: These events will likely relate to the **feet, reproductive, and excretory systems...
[2025-11-08 19:32:42] Response: 200 - Time: 14.66s
INFO:     None:0 - "POST /api/chat/ask HTTP/1.1" 200 OK
[2025-11-08 19:32:42] POST /api/chat/message - Client: None
[2025-11-08 19:32:42] Response: 200 - Time: 0.01s
INFO:     None:0 - "POST /api/chat/message HTTP/1.1" 200 OK
[2025-11-08 19:33:36] POST /api/chat/message - Client: None
[2025-11-08 19:33:36] Response: 200 - Time: 0.01s
INFO:     None:0 - "POST /api/chat/message HTTP/1.1" 200 OK
[2025-11-08 19:33:36] POST /api/chat/ask - Client: None

=== STREAMING STARTED ===
Request question: What is activating these problems next month?
Request data: name='Deepika Yadav' date='1981-03-22' time='16:07' place='28.1956468, 76.6165179' latitude=28.1956468 longitude=76.6165179 timezone='UTC+5' gender=None question='What is activating these problems next month?' language='english' response_style='concise'

=== CHAT ROUTE DEBUG ===
Question: What is activating these problems next month?
Birth data: {'name': 'Deepika Yadav', 'date': '1981-03-22', 'time': '16:07', 'place': '28.1956468, 76.6165179', 'latitude': 28.1956468, 'longitude': 76.6165179, 'timezone': 'UTC+5', 'gender': None}
Context type: <class 'dict'>
History length: 0

=== SENDING TO AI ===
Question: What is activating these problems next month?
Prompt length: 145151 chars
Context keys: ['birth_details', 'ascendant_info', 'd1_chart', 'divisional_charts', 'planetary_analysis', 'special_points', 'relationships', 'yogas', 'chara_karakas', 'advanced_analysis', 'current_dashas', 'transit_activations', 'current_date_info']
History messages: 0

=== RECEIVED FROM AI ===
Response length: 560 chars
Response preview: **Quick Answer**: The problems next month (December 2025) are primarily activated by the ongoing **Saturn-Ketu-Mars-Venus-Saturn dasha**, indicating challenges related to sudden transformations, wealt...
AI result success: True
AI result keys: ['success', 'response', 'raw_response']
Sending response length: 560
Response preview: **Quick Answer**: The problems next month (December 2025) are primarily activated by the ongoing **S...
[2025-11-08 19:33:54] Response: 200 - Time: 17.59s
INFO:     None:0 - "POST /api/chat/ask HTTP/1.1" 200 OK
[2025-11-08 19:33:54] POST /api/chat/message - Client: None
[2025-11-08 19:33:54] Response: 200 - Time: 0.01s
INFO:     None:0 - "POST /api/chat/message HTTP/1.1" 200 OK
[2025-11-08 19:34:54] POST /api/chat/message - Client: None
[2025-11-08 19:34:54] Response: 200 - Time: 0.02s
INFO:     None:0 - "POST /api/chat/message HTTP/1.1" 200 OK
